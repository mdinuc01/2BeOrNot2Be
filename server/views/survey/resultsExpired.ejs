   <!--
    File Name: resultsExpired.ejs
    Group 2: 2BeOrNot2Be 
    -->

<%- include ../Partials/header.ejs%>
<%- include ../Partials/main_nav.ejs%>

        <main class="container-fluid">
            <%let questionNum = 1 %>
            <%let counter = 0 %>
             <% for(let count=0; count < answerList.length; count++) { %>
            <% if(answerList[count].surveyId == surveyId) { %>
             <%counter++ %>
             <% } %>
             <% } %>
            <div class="jumbotron bg-light p-5 rounded-lg m-3 container-fluid jum">
                <h1>
                    <%= title%> - <%=surveyToView.name%>
                </h1>  
                <br>
                <% if(counter < 1) { %>
                <div style="background-color: rgb(165, 164, 164); height: 200px; border-radius: 5px;">
                        <br>
                        <br>
                        <br>
                     <h2 style="text-align: center;">This survery was never answered</h2>
                     </div>
                <br>
                  <a href="/survey-list/expired" class="btn btn-warning" id="return"><i class="fas fa-undo-alt"></i><br><b>Return to <br>Previous Page</b></a>

                <% } else { %>
                    <h4>Survey Participants</h4>
                    <table class="table table-bordered table-striped table-hover col-md-3" id="results">
                    <tr>
                    <th class="text-center" scope="col-1">Submission</th>
                    <th class="text-center" scope="col-1">Answered By</th>
                    <th class="text-center" scope="col-1">Answered On</th>
                    </tr>
                    <% let answerP = 1%>
                    <% for(let counts=0; counts < answerList.length; counts++) { %>
                    <% if(answerList[counts].surveyId == surveyId) { %>
                    <tr>
                        <td class="class text-center col-1">
                            <p><%=answerP%></p>
                            <% answerP++%>
                        </td>
                        <td class="class text-center col-1">
                            <% if(answerList[counts].answeredBy == "Unknown") { %>
                            <span>Unregistered User</span>
                            <% }  else {%>
                            <span><%=answerList[counts].answeredBy%></span>
                            <% } %>
                            </td>
                            <td class="class text-center col-1">
                                <%let date = answerList[counts].answeredOn%>
                                <%let dateF = date.toString()%>
                                <%=dateF.substring(0,21) + " Hours"%>
                                 </td>
                    </tr>
                    <% } %>
                    <% } %>
                </table>
                <br>
                
                 <% for(let count=1; count <= questions; count++) { %>
                 <%if (count ==1) {%>
                 <table id="q1">
                     <th><h4 style="font-family: bebas_neuebold; width: 100%;">Question <%=count%> - <%=surveyToView.q1%></h4></th>
                    </table>
                 <%} else if(count ==2) {%>
                    <table id="q2">
                        <th><h4 style="font-family: bebas_neuebold; width: 100%;">Question <%=count%> - <%=surveyToView.q2%></h4></th>
                       </table>
                 <%} else if(count ==3) {%>
                    <table id="q3">
                        <th><h4 style="font-family: bebas_neuebold; width: 100%;">Question <%=count%> - <%=surveyToView.q3%></h4></th>
                       </table>
                 <%} else if(count ==4) {%>
                    <table id="q4"> 
                        <th><h4 style="font-family: bebas_neuebold; width: 100%;">Question <%=count%> - <%=surveyToView.q4%></h4></th>
                       </table>
                 <%} else if(count ==5) {%>
                    <table id="q5">
                        <th><h4 style="font-family: bebas_neuebold; width: 100%;">Question <%=count%> - <%=surveyToView.q5%></h4></th>
                       </table>
                 <%} else if(count ==6) {%>
                    <table id="q6">
                        <th><h4 style="font-family: bebas_neuebold; width: 100%;">Question <%=count%> - <%=surveyToView.q6%></h4></th>
                       </table>
                 <%} else if(count ==7) {%>
                    <table id="q7">
                        <th><h4 style="font-family: bebas_neuebold; width: 100%;">Question <%=count%> - <%=surveyToView.q7%></h4></th>
                       </table>
                 <%} else if(count ==8) {%>
                    <table id="q8">
                        <th><h4 style="font-family: bebas_neuebold; width: 100%;">Question <%=count%> - <%=surveyToView.q8%></h4></th>
                       </table>
                 <%} else if(count ==9) {%>
                    <table id="q9">
                        <th><h4 style="font-family: bebas_neuebold; width: 100%;">Question <%=count%> - <%=surveyToView.q9%></h4></th>
                       </table>
                 <%} else if(count ==10) {%>
                    <table id="q10">
                        <th><h4 style="font-family: bebas_neuebold; width: 100%;">Question <%=count%> - <%=surveyToView.q10%></h4></th>
                       </table>
                 <% } %>
                 
                 <%let nameQ = "resultsAnswers" + count%>
                
                <table class="table table-bordered table-striped table-hover col-md-6" id="<%=nameQ%>">
                    <!-- Header Row-->
                    <tr>
                        <th class="text-center" scope="col-1">Submission</th>
                        <th class="text-center" scope="col-5">Answer</th>
                        
                        
                    </tr>
                    
                    <!-- Repeatable Template Row-->
                    <% let submission = 1%>
                    <% for(let counts=0; counts < answerList.length; counts++) { %>
                    
                        <% if(answerList[counts].surveyId == surveyId) { %>
                        <tr>
                            <td class="class text-center col-1">
                                <p><%=submission%></p>
                                <% submission++%>
                            </td>
                            <td class="class text-center col-5">
                                <% if(count == 1) { %>
                                    <%=answerList[counts].a1%>
                                <% }else if(count == 2) { %>
                                    <%=answerList[counts].a2%>
                                <% } else if(count == 3) { %>
                                    <%=answerList[counts].a3%>
                                <% } else if(count == 4) { %>
                                    <%=answerList[counts].a4%>
                                <% } else if(count == 5) { %>
                                    <%=answerList[counts].a5%>
                                <% } else if(count == 6) { %>
                                    <%=answerList[counts].a6%>
                                <% } else if(count == 7) { %>
                                <%=answerList[counts].a7%>
                                <% } else if(count == 8) { %>
                                <%=answerList[counts].a8%>
                                <% } else if(count == 9) { %>
                                <%=answerList[counts].a9%>
                                <% } else if(count == 10) { %>
                                    <%=answerList[counts].a10%>
                                <% } %>
                                
                                
                                    </td>
                                    
                        </tr>

                        <% } %>
                        <% } %>
                        
                </table>
                <br>
                <% } %>
                
                <a style="font-family: Verdana, Geneva, Tahoma, sans-serif;"
                        class="btn btn-primary" role="button" id="download"><i class="fas fa-download"></i>
                        <b>Download Results</b></a>
                        <a href="/survey-list/expired" class="btn btn-warning" id="return"><i class="fas fa-undo-alt"></i><br><b>Return to <br>Suverys Page</b></a>
                        <% } %>
                        
                       <%if(surveyToView.numQuestions == 1) {%>
                            <script>
                                function html_table_to_excel(type)
                                                 {
                                                    let tbl1 = document.getElementById("results");
                                                    let tbl2 = document.getElementById("resultsAnswers1");
                                                    
                                                    let q1 = document.getElementById("q1");
                                                    
                                                    let worksheet_tmp1 = XLSX.utils.table_to_sheet(tbl1);
                                                    let worksheet_tmp2 = XLSX.utils.table_to_sheet(tbl2);
                                                    
                                                    let worksheet_q1 = XLSX.utils.table_to_sheet(q1);
                                                    
                                                    let a = XLSX.utils.sheet_to_json(worksheet_tmp1, { header: 1 });
                                                    let l = XLSX.utils.sheet_to_json(worksheet_q1, { header: 1 });

                                                    let b = XLSX.utils.sheet_to_json(worksheet_tmp2, { header: 1 });
                                                    
                                                    b =l.concat(['']).concat(b)
                                                    
                                                    let worksheet = XLSX.utils.json_to_sheet(a, { skipHeader: true })
                                                    let worksheet2 = XLSX.utils.json_to_sheet(b, { skipHeader: true })

                                                    const new_workbook = XLSX.utils.book_new()
                                                    XLSX.utils.book_append_sheet(new_workbook, worksheet, "Submissions Info");
                                                    XLSX.utils.book_append_sheet(new_workbook, worksheet2, "Responses");
                                                    XLSX.writeFile(new_workbook, '<%=surveyToView.name%> Results.xls')
                                                     
                                                 }
                                             
                                                 const export_button = document.getElementById('download');
                                             
                                                 export_button.addEventListener('click', () =>  {
                                                     html_table_to_excel('xlsx');
                                                 });
                            </script>
                            <%} else if(surveyToView.numQuestions == 2) {%>
                                <script>
                                    function html_table_to_excel(type)
                                                 {
                                                    let tbl1 = document.getElementById("results");
                                                    let tbl2 = document.getElementById("resultsAnswers1");
                                                    let tbl3 = document.getElementById("resultsAnswers2");
                                                    
                                                    let q1 = document.getElementById("q1");
                                                    let q2 = document.getElementById("q2");
                                                    
                                                    let worksheet_tmp1 = XLSX.utils.table_to_sheet(tbl1);
                                                    let worksheet_tmp2 = XLSX.utils.table_to_sheet(tbl2);
                                                    let worksheet_tmp3 = XLSX.utils.table_to_sheet(tbl3);
                                                    
                                                    let worksheet_q1 = XLSX.utils.table_to_sheet(q1);
                                                    let worksheet_q2 = XLSX.utils.table_to_sheet(q2);
                                                    
                                                    let a = XLSX.utils.sheet_to_json(worksheet_tmp1, { header: 1 });
                                                    let l = XLSX.utils.sheet_to_json(worksheet_q1, { header: 1 });

                                                    let b = XLSX.utils.sheet_to_json(worksheet_tmp2, { header: 1 });
                                                    let m = XLSX.utils.sheet_to_json(worksheet_q2, { header: 1 });

                                                    let c = XLSX.utils.sheet_to_json(worksheet_tmp3, { header: 1 });
                                                    
                                                    b =l.concat(['']).concat(b).concat(['']).concat(m).concat(['']).concat(c)
                                                    
                                                    let worksheet = XLSX.utils.json_to_sheet(a, { skipHeader: true })
                                                    let worksheet2 = XLSX.utils.json_to_sheet(b, { skipHeader: true })

                                                    const new_workbook = XLSX.utils.book_new()
                                                    XLSX.utils.book_append_sheet(new_workbook, worksheet, "Submissions Info");
                                                    XLSX.utils.book_append_sheet(new_workbook, worksheet2, "Responses");
                                                    XLSX.writeFile(new_workbook, '<%=surveyToView.name%> Results.xls')
                                                     
                                                 }
                                             
                                                 const export_button = document.getElementById('download');
                                             
                                                 export_button.addEventListener('click', () =>  {
                                                     html_table_to_excel('xlsx');
                                                 });
                                </script>
                        <%} else if(surveyToView.numQuestions == 3) {%>
                        <script>
                            function html_table_to_excel(type)
                                                 {
                                                    let tbl1 = document.getElementById("results");
                                                    let tbl2 = document.getElementById("resultsAnswers1");
                                                    let tbl3 = document.getElementById("resultsAnswers2");
                                                    let tbl4 = document.getElementById("resultsAnswers3");
                                                    
                                                    let q1 = document.getElementById("q1");
                                                    let q2 = document.getElementById("q2");
                                                    let q3 = document.getElementById("q3");
                                                    
                                                    let worksheet_tmp1 = XLSX.utils.table_to_sheet(tbl1);
                                                    let worksheet_tmp2 = XLSX.utils.table_to_sheet(tbl2);
                                                    let worksheet_tmp3 = XLSX.utils.table_to_sheet(tbl3);
                                                    let worksheet_tmp4 = XLSX.utils.table_to_sheet(tbl4);
                                                    
                                                    let worksheet_q1 = XLSX.utils.table_to_sheet(q1);
                                                    let worksheet_q2 = XLSX.utils.table_to_sheet(q2);
                                                    let worksheet_q3 = XLSX.utils.table_to_sheet(q3);
                                                    
                                                    let a = XLSX.utils.sheet_to_json(worksheet_tmp1, { header: 1 });
                                                    let l = XLSX.utils.sheet_to_json(worksheet_q1, { header: 1 });

                                                    let b = XLSX.utils.sheet_to_json(worksheet_tmp2, { header: 1 });
                                                    let m = XLSX.utils.sheet_to_json(worksheet_q2, { header: 1 });

                                                    let c = XLSX.utils.sheet_to_json(worksheet_tmp3, { header: 1 });
                                                    let n = XLSX.utils.sheet_to_json(worksheet_q3, { header: 1 });

                                                    let d = XLSX.utils.sheet_to_json(worksheet_tmp4, { header: 1 });
                                                    
                                                    b =l.concat(['']).concat(b).concat(['']).concat(m).concat(['']).concat(c).concat(['']).concat(n).concat(['']).concat(d)
                                                    
                                                    let worksheet = XLSX.utils.json_to_sheet(a, { skipHeader: true })
                                                    let worksheet2 = XLSX.utils.json_to_sheet(b, { skipHeader: true })

                                                    const new_workbook = XLSX.utils.book_new()
                                                    XLSX.utils.book_append_sheet(new_workbook, worksheet, "Submissions Info");
                                                    XLSX.utils.book_append_sheet(new_workbook, worksheet2, "Responses");
                                                    XLSX.writeFile(new_workbook, '<%=surveyToView.name%> Results.xls')
                                                     
                                                 }
                                             
                                                 const export_button = document.getElementById('download');
                                             
                                                 export_button.addEventListener('click', () =>  {
                                                     html_table_to_excel('xlsx');
                                                 });
                        </script>
                        <%} else if (surveyToView.numQuestions == 4) {%>
                            <script>
                                function html_table_to_excel(type)
                                                 {
                                                    let tbl1 = document.getElementById("results");
                                                    let tbl2 = document.getElementById("resultsAnswers1");
                                                    let tbl3 = document.getElementById("resultsAnswers2");
                                                    let tbl4 = document.getElementById("resultsAnswers3");
                                                    let tbl5 = document.getElementById("resultsAnswers4");
                                                    
                                                    let q1 = document.getElementById("q1");
                                                    let q2 = document.getElementById("q2");
                                                    let q3 = document.getElementById("q3");
                                                    let q4 = document.getElementById("q4");
                                                   
                                                    let worksheet_tmp1 = XLSX.utils.table_to_sheet(tbl1);
                                                    let worksheet_tmp2 = XLSX.utils.table_to_sheet(tbl2);
                                                    let worksheet_tmp3 = XLSX.utils.table_to_sheet(tbl3);
                                                    let worksheet_tmp4 = XLSX.utils.table_to_sheet(tbl4);
                                                    let worksheet_tmp5 = XLSX.utils.table_to_sheet(tbl5);
                                                    
                                                    let worksheet_q1 = XLSX.utils.table_to_sheet(q1);
                                                    let worksheet_q2 = XLSX.utils.table_to_sheet(q2);
                                                    let worksheet_q3 = XLSX.utils.table_to_sheet(q3);
                                                    let worksheet_q4 = XLSX.utils.table_to_sheet(q4);
                                                    
                                                    let a = XLSX.utils.sheet_to_json(worksheet_tmp1, { header: 1 });
                                                    let l = XLSX.utils.sheet_to_json(worksheet_q1, { header: 1 });

                                                    let b = XLSX.utils.sheet_to_json(worksheet_tmp2, { header: 1 });
                                                    let m = XLSX.utils.sheet_to_json(worksheet_q2, { header: 1 });

                                                    let c = XLSX.utils.sheet_to_json(worksheet_tmp3, { header: 1 });
                                                    let n = XLSX.utils.sheet_to_json(worksheet_q3, { header: 1 });

                                                    let d = XLSX.utils.sheet_to_json(worksheet_tmp4, { header: 1 });
                                                    let o = XLSX.utils.sheet_to_json(worksheet_q4, { header: 1 });

                                                    let e = XLSX.utils.sheet_to_json(worksheet_tmp5, { header: 1 });
                                                   
                                                    b =l.concat(['']).concat(b).concat(['']).concat(m).concat(['']).concat(c).concat(['']).concat(n).concat(['']).concat(d).concat(['']).concat(o).concat(['']).concat(e)
                                                    
                                                    let worksheet = XLSX.utils.json_to_sheet(a, { skipHeader: true })
                                                    let worksheet2 = XLSX.utils.json_to_sheet(b, { skipHeader: true })

                                                    const new_workbook = XLSX.utils.book_new()
                                                    XLSX.utils.book_append_sheet(new_workbook, worksheet, "Submissions Info");
                                                    XLSX.utils.book_append_sheet(new_workbook, worksheet2, "Responses");
                                                    XLSX.writeFile(new_workbook, '<%=surveyToView.name%> Results.xls')
                                                     
                                                 }
                                             
                                                 const export_button = document.getElementById('download');
                                             
                                                 export_button.addEventListener('click', () =>  {
                                                     html_table_to_excel('xlsx');
                                                 });
                            </script>
                            <%} else if (surveyToView.numQuestions == 5) {%>
                                <script>
                                    function html_table_to_excel(type)
                                                 {
                                                    let tbl1 = document.getElementById("results");
                                                    let tbl2 = document.getElementById("resultsAnswers1");
                                                    let tbl3 = document.getElementById("resultsAnswers2");
                                                    let tbl4 = document.getElementById("resultsAnswers3");
                                                    let tbl5 = document.getElementById("resultsAnswers4");
                                                    let tbl6 = document.getElementById("resultsAnswers5");
                                                    
                                                    let q1 = document.getElementById("q1");
                                                    let q2 = document.getElementById("q2");
                                                    let q3 = document.getElementById("q3");
                                                    let q4 = document.getElementById("q4");
                                                    let q5 = document.getElementById("q5");
                                                    
                                                    let worksheet_tmp1 = XLSX.utils.table_to_sheet(tbl1);
                                                    let worksheet_tmp2 = XLSX.utils.table_to_sheet(tbl2);
                                                    let worksheet_tmp3 = XLSX.utils.table_to_sheet(tbl3);
                                                    let worksheet_tmp4 = XLSX.utils.table_to_sheet(tbl4);
                                                    let worksheet_tmp5 = XLSX.utils.table_to_sheet(tbl5);
                                                    let worksheet_tmp6 = XLSX.utils.table_to_sheet(tbl6);
                                                    
                                                    let worksheet_q1 = XLSX.utils.table_to_sheet(q1);
                                                    let worksheet_q2 = XLSX.utils.table_to_sheet(q2);
                                                    let worksheet_q3 = XLSX.utils.table_to_sheet(q3);
                                                    let worksheet_q4 = XLSX.utils.table_to_sheet(q4);
                                                    let worksheet_q5 = XLSX.utils.table_to_sheet(q5);
                                                    
                                                    let a = XLSX.utils.sheet_to_json(worksheet_tmp1, { header: 1 });
                                                    let l = XLSX.utils.sheet_to_json(worksheet_q1, { header: 1 });

                                                    let b = XLSX.utils.sheet_to_json(worksheet_tmp2, { header: 1 });
                                                    let m = XLSX.utils.sheet_to_json(worksheet_q2, { header: 1 });

                                                    let c = XLSX.utils.sheet_to_json(worksheet_tmp3, { header: 1 });
                                                    let n = XLSX.utils.sheet_to_json(worksheet_q3, { header: 1 });

                                                    let d = XLSX.utils.sheet_to_json(worksheet_tmp4, { header: 1 });
                                                    let o = XLSX.utils.sheet_to_json(worksheet_q4, { header: 1 });

                                                    let e = XLSX.utils.sheet_to_json(worksheet_tmp5, { header: 1 });
                                                    let p = XLSX.utils.sheet_to_json(worksheet_q5, { header: 1 });

                                                    let f = XLSX.utils.sheet_to_json(worksheet_tmp6, { header: 1 });
                                                    
                                                    b =l.concat(['']).concat(b).concat(['']).concat(m).concat(['']).concat(c).concat(['']).concat(n).concat(['']).concat(d).concat(['']).concat(o).concat(['']).concat(e).concat(['']).concat(p).concat(['']).concat(f)
                                                    
                                                    let worksheet = XLSX.utils.json_to_sheet(a, { skipHeader: true })
                                                    let worksheet2 = XLSX.utils.json_to_sheet(b, { skipHeader: true })

                                                    const new_workbook = XLSX.utils.book_new()
                                                    XLSX.utils.book_append_sheet(new_workbook, worksheet, "Submissions Info");
                                                    XLSX.utils.book_append_sheet(new_workbook, worksheet2, "Responses");
                                                    XLSX.writeFile(new_workbook, '<%=surveyToView.name%> Results.xls')
                                                     
                                                 }
                                             
                                                 const export_button = document.getElementById('download');
                                             
                                                 export_button.addEventListener('click', () =>  {
                                                     html_table_to_excel('xlsx');
                                                 });
                                </script>
                                <%} else if (surveyToView.numQuestions == 6) {%>
                                    <script>
                                       function html_table_to_excel(type)
                                                 {
                                                    let tbl1 = document.getElementById("results");
                                                    let tbl2 = document.getElementById("resultsAnswers1");
                                                    let tbl3 = document.getElementById("resultsAnswers2");
                                                    let tbl4 = document.getElementById("resultsAnswers3");
                                                    let tbl5 = document.getElementById("resultsAnswers4");
                                                    let tbl6 = document.getElementById("resultsAnswers5");
                                                    let tbl7 = document.getElementById("resultsAnswers6");
                                                    
                                                    let q1 = document.getElementById("q1");
                                                    let q2 = document.getElementById("q2");
                                                    let q3 = document.getElementById("q3");
                                                    let q4 = document.getElementById("q4");
                                                    let q5 = document.getElementById("q5");
                                                    let q6 = document.getElementById("q6");
                                                    
                                                    let worksheet_tmp1 = XLSX.utils.table_to_sheet(tbl1);
                                                    let worksheet_tmp2 = XLSX.utils.table_to_sheet(tbl2);
                                                    let worksheet_tmp3 = XLSX.utils.table_to_sheet(tbl3);
                                                    let worksheet_tmp4 = XLSX.utils.table_to_sheet(tbl4);
                                                    let worksheet_tmp5 = XLSX.utils.table_to_sheet(tbl5);
                                                    let worksheet_tmp6 = XLSX.utils.table_to_sheet(tbl6);
                                                    let worksheet_tmp7 = XLSX.utils.table_to_sheet(tbl7);
                                                    
                                                    let worksheet_q1 = XLSX.utils.table_to_sheet(q1);
                                                    let worksheet_q2 = XLSX.utils.table_to_sheet(q2);
                                                    let worksheet_q3 = XLSX.utils.table_to_sheet(q3);
                                                    let worksheet_q4 = XLSX.utils.table_to_sheet(q4);
                                                    let worksheet_q5 = XLSX.utils.table_to_sheet(q5);
                                                    let worksheet_q6 = XLSX.utils.table_to_sheet(q6);
                                                    
                                                    let a = XLSX.utils.sheet_to_json(worksheet_tmp1, { header: 1 });
                                                    let l = XLSX.utils.sheet_to_json(worksheet_q1, { header: 1 });

                                                    let b = XLSX.utils.sheet_to_json(worksheet_tmp2, { header: 1 });
                                                    let m = XLSX.utils.sheet_to_json(worksheet_q2, { header: 1 });

                                                    let c = XLSX.utils.sheet_to_json(worksheet_tmp3, { header: 1 });
                                                    let n = XLSX.utils.sheet_to_json(worksheet_q3, { header: 1 });

                                                    let d = XLSX.utils.sheet_to_json(worksheet_tmp4, { header: 1 });
                                                    let o = XLSX.utils.sheet_to_json(worksheet_q4, { header: 1 });

                                                    let e = XLSX.utils.sheet_to_json(worksheet_tmp5, { header: 1 });
                                                    let p = XLSX.utils.sheet_to_json(worksheet_q5, { header: 1 });

                                                    let f = XLSX.utils.sheet_to_json(worksheet_tmp6, { header: 1 });
                                                    let q = XLSX.utils.sheet_to_json(worksheet_q6, { header: 1 });

                                                    let g = XLSX.utils.sheet_to_json(worksheet_tmp7, { header: 1 });
                                                   
                                                    b =l.concat(['']).concat(b).concat(['']).concat(m).concat(['']).concat(c).concat(['']).concat(n).concat(['']).concat(d).concat(['']).concat(o).concat(['']).concat(e).concat(['']).concat(p).concat(['']).concat(f).concat(['']).concat(q).concat(['']).concat(g)
                                                    
                                                    let worksheet = XLSX.utils.json_to_sheet(a, { skipHeader: true })
                                                    let worksheet2 = XLSX.utils.json_to_sheet(b, { skipHeader: true })

                                                    const new_workbook = XLSX.utils.book_new()
                                                    XLSX.utils.book_append_sheet(new_workbook, worksheet, "Submissions Info");
                                                    XLSX.utils.book_append_sheet(new_workbook, worksheet2, "Responses");
                                                    XLSX.writeFile(new_workbook, '<%=surveyToView.name%> Results.xls')
                                                     
                                                 }
                                             
                                                 const export_button = document.getElementById('download');
                                             
                                                 export_button.addEventListener('click', () =>  {
                                                     html_table_to_excel('xlsx');
                                                 });
                                    </script>
                                    <%} else if (surveyToView.numQuestions == 7) {%>
                                        <script>
                                            function html_table_to_excel(type)
                                                 {
                                                    let tbl1 = document.getElementById("results");
                                                    let tbl2 = document.getElementById("resultsAnswers1");
                                                    let tbl3 = document.getElementById("resultsAnswers2");
                                                    let tbl4 = document.getElementById("resultsAnswers3");
                                                    let tbl5 = document.getElementById("resultsAnswers4");
                                                    let tbl6 = document.getElementById("resultsAnswers5");
                                                    let tbl7 = document.getElementById("resultsAnswers6");
                                                    let tbl8 = document.getElementById("resultsAnswers7");
                                                   
                                                    let q1 = document.getElementById("q1");
                                                    let q2 = document.getElementById("q2");
                                                    let q3 = document.getElementById("q3");
                                                    let q4 = document.getElementById("q4");
                                                    let q5 = document.getElementById("q5");
                                                    let q6 = document.getElementById("q6");
                                                    let q7 = document.getElementById("q7");
                                                   
                                                    let worksheet_tmp1 = XLSX.utils.table_to_sheet(tbl1);
                                                    let worksheet_tmp2 = XLSX.utils.table_to_sheet(tbl2);
                                                    let worksheet_tmp3 = XLSX.utils.table_to_sheet(tbl3);
                                                    let worksheet_tmp4 = XLSX.utils.table_to_sheet(tbl4);
                                                    let worksheet_tmp5 = XLSX.utils.table_to_sheet(tbl5);
                                                    let worksheet_tmp6 = XLSX.utils.table_to_sheet(tbl6);
                                                    let worksheet_tmp7 = XLSX.utils.table_to_sheet(tbl7);
                                                    let worksheet_tmp8 = XLSX.utils.table_to_sheet(tbl8);
                                                    
                                                    let worksheet_q1 = XLSX.utils.table_to_sheet(q1);
                                                    let worksheet_q2 = XLSX.utils.table_to_sheet(q2);
                                                    let worksheet_q3 = XLSX.utils.table_to_sheet(q3);
                                                    let worksheet_q4 = XLSX.utils.table_to_sheet(q4);
                                                    let worksheet_q5 = XLSX.utils.table_to_sheet(q5);
                                                    let worksheet_q6 = XLSX.utils.table_to_sheet(q6);
                                                    let worksheet_q7 = XLSX.utils.table_to_sheet(q7);
                                                    
                                                    let a = XLSX.utils.sheet_to_json(worksheet_tmp1, { header: 1 });
                                                    let l = XLSX.utils.sheet_to_json(worksheet_q1, { header: 1 });

                                                    let b = XLSX.utils.sheet_to_json(worksheet_tmp2, { header: 1 });
                                                    let m = XLSX.utils.sheet_to_json(worksheet_q2, { header: 1 });

                                                    let c = XLSX.utils.sheet_to_json(worksheet_tmp3, { header: 1 });
                                                    let n = XLSX.utils.sheet_to_json(worksheet_q3, { header: 1 });

                                                    let d = XLSX.utils.sheet_to_json(worksheet_tmp4, { header: 1 });
                                                    let o = XLSX.utils.sheet_to_json(worksheet_q4, { header: 1 });

                                                    let e = XLSX.utils.sheet_to_json(worksheet_tmp5, { header: 1 });
                                                    let p = XLSX.utils.sheet_to_json(worksheet_q5, { header: 1 });

                                                    let f = XLSX.utils.sheet_to_json(worksheet_tmp6, { header: 1 });
                                                    let q = XLSX.utils.sheet_to_json(worksheet_q6, { header: 1 });

                                                    let g = XLSX.utils.sheet_to_json(worksheet_tmp7, { header: 1 });
                                                    let r = XLSX.utils.sheet_to_json(worksheet_q7, { header: 1 });

                                                    let h = XLSX.utils.sheet_to_json(worksheet_tmp8, { header: 1 });
                                                   
                                                    b =l.concat(['']).concat(b).concat(['']).concat(m).concat(['']).concat(c).concat(['']).concat(n).concat(['']).concat(d).concat(['']).concat(o).concat(['']).concat(e).concat(['']).concat(p).concat(['']).concat(f).concat(['']).concat(q).concat(['']).concat(g).concat(['']).concat(r).concat(['']).concat(h)
                                                    
                                                    let worksheet = XLSX.utils.json_to_sheet(a, { skipHeader: true })
                                                    let worksheet2 = XLSX.utils.json_to_sheet(b, { skipHeader: true })

                                                    const new_workbook = XLSX.utils.book_new()
                                                    XLSX.utils.book_append_sheet(new_workbook, worksheet, "Submissions Info");
                                                    XLSX.utils.book_append_sheet(new_workbook, worksheet2, "Responses");
                                                    XLSX.writeFile(new_workbook, '<%=surveyToView.name%> Results.xls')
                                                     
                                                 }
                                             
                                                 const export_button = document.getElementById('download');
                                             
                                                 export_button.addEventListener('click', () =>  {
                                                     html_table_to_excel('xlsx');
                                                 });
                                        </script>
                                        <%} else if (surveyToView.numQuestions == 8) {%>
                                            <script>
                                                function html_table_to_excel(type)
                                                 {
                                                    let tbl1 = document.getElementById("results");
                                                    let tbl2 = document.getElementById("resultsAnswers1");
                                                    let tbl3 = document.getElementById("resultsAnswers2");
                                                    let tbl4 = document.getElementById("resultsAnswers3");
                                                    let tbl5 = document.getElementById("resultsAnswers4");
                                                    let tbl6 = document.getElementById("resultsAnswers5");
                                                    let tbl7 = document.getElementById("resultsAnswers6");
                                                    let tbl8 = document.getElementById("resultsAnswers7");
                                                    let tbl9 = document.getElementById("resultsAnswers8");
                                                    
                                                    let q1 = document.getElementById("q1");
                                                    let q2 = document.getElementById("q2");
                                                    let q3 = document.getElementById("q3");
                                                    let q4 = document.getElementById("q4");
                                                    let q5 = document.getElementById("q5");
                                                    let q6 = document.getElementById("q6");
                                                    let q7 = document.getElementById("q7");
                                                    let q8 = document.getElementById("q8");
                                                    
                                                    let worksheet_tmp1 = XLSX.utils.table_to_sheet(tbl1);
                                                    let worksheet_tmp2 = XLSX.utils.table_to_sheet(tbl2);
                                                    let worksheet_tmp3 = XLSX.utils.table_to_sheet(tbl3);
                                                    let worksheet_tmp4 = XLSX.utils.table_to_sheet(tbl4);
                                                    let worksheet_tmp5 = XLSX.utils.table_to_sheet(tbl5);
                                                    let worksheet_tmp6 = XLSX.utils.table_to_sheet(tbl6);
                                                    let worksheet_tmp7 = XLSX.utils.table_to_sheet(tbl7);
                                                    let worksheet_tmp8 = XLSX.utils.table_to_sheet(tbl8);
                                                    let worksheet_tmp9 = XLSX.utils.table_to_sheet(tbl9);
                                                    
                                                    let worksheet_q1 = XLSX.utils.table_to_sheet(q1);
                                                    let worksheet_q2 = XLSX.utils.table_to_sheet(q2);
                                                    let worksheet_q3 = XLSX.utils.table_to_sheet(q3);
                                                    let worksheet_q4 = XLSX.utils.table_to_sheet(q4);
                                                    let worksheet_q5 = XLSX.utils.table_to_sheet(q5);
                                                    let worksheet_q6 = XLSX.utils.table_to_sheet(q6);
                                                    let worksheet_q7 = XLSX.utils.table_to_sheet(q7);
                                                    let worksheet_q8 = XLSX.utils.table_to_sheet(q8);
                                                   
                                                    let a = XLSX.utils.sheet_to_json(worksheet_tmp1, { header: 1 });
                                                    let l = XLSX.utils.sheet_to_json(worksheet_q1, { header: 1 });

                                                    let b = XLSX.utils.sheet_to_json(worksheet_tmp2, { header: 1 });
                                                    let m = XLSX.utils.sheet_to_json(worksheet_q2, { header: 1 });

                                                    let c = XLSX.utils.sheet_to_json(worksheet_tmp3, { header: 1 });
                                                    let n = XLSX.utils.sheet_to_json(worksheet_q3, { header: 1 });

                                                    let d = XLSX.utils.sheet_to_json(worksheet_tmp4, { header: 1 });
                                                    let o = XLSX.utils.sheet_to_json(worksheet_q4, { header: 1 });

                                                    let e = XLSX.utils.sheet_to_json(worksheet_tmp5, { header: 1 });
                                                    let p = XLSX.utils.sheet_to_json(worksheet_q5, { header: 1 });

                                                    let f = XLSX.utils.sheet_to_json(worksheet_tmp6, { header: 1 });
                                                    let q = XLSX.utils.sheet_to_json(worksheet_q6, { header: 1 });

                                                    let g = XLSX.utils.sheet_to_json(worksheet_tmp7, { header: 1 });
                                                    let r = XLSX.utils.sheet_to_json(worksheet_q7, { header: 1 });

                                                    let h = XLSX.utils.sheet_to_json(worksheet_tmp8, { header: 1 });
                                                    let s = XLSX.utils.sheet_to_json(worksheet_q8, { header: 1 });

                                                    let i = XLSX.utils.sheet_to_json(worksheet_tmp9, { header: 1 });
                                                    
                                                    b =l.concat(['']).concat(b).concat(['']).concat(m).concat(['']).concat(c).concat(['']).concat(n).concat(['']).concat(d).concat(['']).concat(o).concat(['']).concat(e).concat(['']).concat(p).concat(['']).concat(f).concat(['']).concat(q).concat(['']).concat(g).concat(['']).concat(r).concat(['']).concat(h).concat(['']).concat(s).concat(['']).concat(i)
                                                    
                                                    let worksheet = XLSX.utils.json_to_sheet(a, { skipHeader: true })
                                                    let worksheet2 = XLSX.utils.json_to_sheet(b, { skipHeader: true })

                                                    const new_workbook = XLSX.utils.book_new()
                                                    XLSX.utils.book_append_sheet(new_workbook, worksheet, "Submissions Info");
                                                    XLSX.utils.book_append_sheet(new_workbook, worksheet2, "Responses");
                                                    XLSX.writeFile(new_workbook, '<%=surveyToView.name%> Results.xls')
                                                     
                                                 }
                                             
                                                 const export_button = document.getElementById('download');
                                             
                                                 export_button.addEventListener('click', () =>  {
                                                     html_table_to_excel('xlsx');
                                                 });
                                            </script>
                                            <%} else if (surveyToView.numQuestions == 9) {%>
                                                <script>
                                                    function html_table_to_excel(type)
                                                 {
                                                    let tbl1 = document.getElementById("results");
                                                    let tbl2 = document.getElementById("resultsAnswers1");
                                                    let tbl3 = document.getElementById("resultsAnswers2");
                                                    let tbl4 = document.getElementById("resultsAnswers3");
                                                    let tbl5 = document.getElementById("resultsAnswers4");
                                                    let tbl6 = document.getElementById("resultsAnswers5");
                                                    let tbl7 = document.getElementById("resultsAnswers6");
                                                    let tbl8 = document.getElementById("resultsAnswers7");
                                                    let tbl9 = document.getElementById("resultsAnswers8");
                                                    let tbl10 = document.getElementById("resultsAnswers9");
                                                    
                                                    let q1 = document.getElementById("q1");
                                                    let q2 = document.getElementById("q2");
                                                    let q3 = document.getElementById("q3");
                                                    let q4 = document.getElementById("q4");
                                                    let q5 = document.getElementById("q5");
                                                    let q6 = document.getElementById("q6");
                                                    let q7 = document.getElementById("q7");
                                                    let q8 = document.getElementById("q8");
                                                    let q9 = document.getElementById("q9");
                                                    
                                                    let worksheet_tmp1 = XLSX.utils.table_to_sheet(tbl1);
                                                    let worksheet_tmp2 = XLSX.utils.table_to_sheet(tbl2);
                                                    let worksheet_tmp3 = XLSX.utils.table_to_sheet(tbl3);
                                                    let worksheet_tmp4 = XLSX.utils.table_to_sheet(tbl4);
                                                    let worksheet_tmp5 = XLSX.utils.table_to_sheet(tbl5);
                                                    let worksheet_tmp6 = XLSX.utils.table_to_sheet(tbl6);
                                                    let worksheet_tmp7 = XLSX.utils.table_to_sheet(tbl7);
                                                    let worksheet_tmp8 = XLSX.utils.table_to_sheet(tbl8);
                                                    let worksheet_tmp9 = XLSX.utils.table_to_sheet(tbl9);
                                                    let worksheet_tmp10 = XLSX.utils.table_to_sheet(tbl10);
                                                    
                                                    let worksheet_q1 = XLSX.utils.table_to_sheet(q1);
                                                    let worksheet_q2 = XLSX.utils.table_to_sheet(q2);
                                                    let worksheet_q3 = XLSX.utils.table_to_sheet(q3);
                                                    let worksheet_q4 = XLSX.utils.table_to_sheet(q4);
                                                    let worksheet_q5 = XLSX.utils.table_to_sheet(q5);
                                                    let worksheet_q6 = XLSX.utils.table_to_sheet(q6);
                                                    let worksheet_q7 = XLSX.utils.table_to_sheet(q7);
                                                    let worksheet_q8 = XLSX.utils.table_to_sheet(q8);
                                                    let worksheet_q9 = XLSX.utils.table_to_sheet(q9);
                                                   
                                                    let a = XLSX.utils.sheet_to_json(worksheet_tmp1, { header: 1 });
                                                    let l = XLSX.utils.sheet_to_json(worksheet_q1, { header: 1 });

                                                    let b = XLSX.utils.sheet_to_json(worksheet_tmp2, { header: 1 });
                                                    let m = XLSX.utils.sheet_to_json(worksheet_q2, { header: 1 });

                                                    let c = XLSX.utils.sheet_to_json(worksheet_tmp3, { header: 1 });
                                                    let n = XLSX.utils.sheet_to_json(worksheet_q3, { header: 1 });

                                                    let d = XLSX.utils.sheet_to_json(worksheet_tmp4, { header: 1 });
                                                    let o = XLSX.utils.sheet_to_json(worksheet_q4, { header: 1 });

                                                    let e = XLSX.utils.sheet_to_json(worksheet_tmp5, { header: 1 });
                                                    let p = XLSX.utils.sheet_to_json(worksheet_q5, { header: 1 });

                                                    let f = XLSX.utils.sheet_to_json(worksheet_tmp6, { header: 1 });
                                                    let q = XLSX.utils.sheet_to_json(worksheet_q6, { header: 1 });

                                                    let g = XLSX.utils.sheet_to_json(worksheet_tmp7, { header: 1 });
                                                    let r = XLSX.utils.sheet_to_json(worksheet_q7, { header: 1 });

                                                    let h = XLSX.utils.sheet_to_json(worksheet_tmp8, { header: 1 });
                                                    let s = XLSX.utils.sheet_to_json(worksheet_q8, { header: 1 });

                                                    let i = XLSX.utils.sheet_to_json(worksheet_tmp9, { header: 1 });
                                                    let t = XLSX.utils.sheet_to_json(worksheet_q9, { header: 1 });

                                                    let j = XLSX.utils.sheet_to_json(worksheet_tmp10, { header: 1 });
                                                  
                        
                                                    b =l.concat(['']).concat(b).concat(['']).concat(m).concat(['']).concat(c).concat(['']).concat(n).concat(['']).concat(d).concat(['']).concat(o).concat(['']).concat(e).concat(['']).concat(p).concat(['']).concat(f).concat(['']).concat(q).concat(['']).concat(g).concat(['']).concat(r).concat(['']).concat(h).concat(['']).concat(s).concat(['']).concat(i).concat(['']).concat(t).concat(['']).concat(j)
                                                    
                                                    let worksheet = XLSX.utils.json_to_sheet(a, { skipHeader: true })
                                                    let worksheet2 = XLSX.utils.json_to_sheet(b, { skipHeader: true })

                                                    const new_workbook = XLSX.utils.book_new()
                                                    XLSX.utils.book_append_sheet(new_workbook, worksheet, "Submissions Info");
                                                    XLSX.utils.book_append_sheet(new_workbook, worksheet2, "Responses");
                                                    XLSX.writeFile(new_workbook, '<%=surveyToView.name%> Results.xls')
                                                     
                                                 }
                                             
                                                 const export_button = document.getElementById('download');
                                             
                                                 export_button.addEventListener('click', () =>  {
                                                     html_table_to_excel('xlsx');
                                                 });
                                                </script>
                                                <%} else if (surveyToView.numQuestions == 10) {%>
                                                    <script>
                                                        function html_table_to_excel(type)
                                                     {
                                                        let tbl1 = document.getElementById("results");
                                                        let tbl2 = document.getElementById("resultsAnswers1");
                                                        let tbl3 = document.getElementById("resultsAnswers2");
                                                        let tbl4 = document.getElementById("resultsAnswers3");
                                                        let tbl5 = document.getElementById("resultsAnswers4");
                                                        let tbl6 = document.getElementById("resultsAnswers5");
                                                        let tbl7 = document.getElementById("resultsAnswers6");
                                                        let tbl8 = document.getElementById("resultsAnswers7");
                                                        let tbl9 = document.getElementById("resultsAnswers8");
                                                        let tbl10 = document.getElementById("resultsAnswers9");
                                                        let tbl11 = document.getElementById("resultsAnswers10");

                                                        let q1 = document.getElementById("q1");
                                                        let q2 = document.getElementById("q2");
                                                        let q3 = document.getElementById("q3");
                                                        let q4 = document.getElementById("q4");
                                                        let q5 = document.getElementById("q5");
                                                        let q6 = document.getElementById("q6");
                                                        let q7 = document.getElementById("q7");
                                                        let q8 = document.getElementById("q8");
                                                        let q9 = document.getElementById("q9");
                                                        let q10 = document.getElementById("q10");

                                                        let worksheet_tmp1 = XLSX.utils.table_to_sheet(tbl1);
                                                        let worksheet_tmp2 = XLSX.utils.table_to_sheet(tbl2);
                                                        let worksheet_tmp3 = XLSX.utils.table_to_sheet(tbl3);
                                                        let worksheet_tmp4 = XLSX.utils.table_to_sheet(tbl4);
                                                        let worksheet_tmp5 = XLSX.utils.table_to_sheet(tbl5);
                                                        let worksheet_tmp6 = XLSX.utils.table_to_sheet(tbl6);
                                                        let worksheet_tmp7 = XLSX.utils.table_to_sheet(tbl7);
                                                        let worksheet_tmp8 = XLSX.utils.table_to_sheet(tbl8);
                                                        let worksheet_tmp9 = XLSX.utils.table_to_sheet(tbl9);
                                                        let worksheet_tmp10 = XLSX.utils.table_to_sheet(tbl10);
                                                        let worksheet_tmp11 = XLSX.utils.table_to_sheet(tbl11);

                                                        let worksheet_q1 = XLSX.utils.table_to_sheet(q1);
                                                        let worksheet_q2 = XLSX.utils.table_to_sheet(q2);
                                                        let worksheet_q3 = XLSX.utils.table_to_sheet(q3);
                                                        let worksheet_q4 = XLSX.utils.table_to_sheet(q4);
                                                        let worksheet_q5 = XLSX.utils.table_to_sheet(q5);
                                                        let worksheet_q6 = XLSX.utils.table_to_sheet(q6);
                                                        let worksheet_q7 = XLSX.utils.table_to_sheet(q7);
                                                        let worksheet_q8 = XLSX.utils.table_to_sheet(q8);
                                                        let worksheet_q9 = XLSX.utils.table_to_sheet(q9);
                                                        let worksheet_q10 = XLSX.utils.table_to_sheet(q10);
                                                        
                            
                                                        let a = XLSX.utils.sheet_to_json(worksheet_tmp1, { header: 1 });
                                                        let l = XLSX.utils.sheet_to_json(worksheet_q1, { header: 1 });

                                                        let b = XLSX.utils.sheet_to_json(worksheet_tmp2, { header: 1 });
                                                        let m = XLSX.utils.sheet_to_json(worksheet_q2, { header: 1 });

                                                        let c = XLSX.utils.sheet_to_json(worksheet_tmp3, { header: 1 });
                                                        let n = XLSX.utils.sheet_to_json(worksheet_q3, { header: 1 });

                                                        let d = XLSX.utils.sheet_to_json(worksheet_tmp4, { header: 1 });
                                                        let o = XLSX.utils.sheet_to_json(worksheet_q4, { header: 1 });

                                                        let e = XLSX.utils.sheet_to_json(worksheet_tmp5, { header: 1 });
                                                        let p = XLSX.utils.sheet_to_json(worksheet_q5, { header: 1 });

                                                        let f = XLSX.utils.sheet_to_json(worksheet_tmp6, { header: 1 });
                                                        let q = XLSX.utils.sheet_to_json(worksheet_q6, { header: 1 });

                                                        let g = XLSX.utils.sheet_to_json(worksheet_tmp7, { header: 1 });
                                                        let r = XLSX.utils.sheet_to_json(worksheet_q7, { header: 1 });

                                                        let h = XLSX.utils.sheet_to_json(worksheet_tmp8, { header: 1 });
                                                        let s = XLSX.utils.sheet_to_json(worksheet_q8, { header: 1 });

                                                        let i = XLSX.utils.sheet_to_json(worksheet_tmp9, { header: 1 });
                                                        let t = XLSX.utils.sheet_to_json(worksheet_q9, { header: 1 });

                                                        let j = XLSX.utils.sheet_to_json(worksheet_tmp10, { header: 1 });
                                                        let u = XLSX.utils.sheet_to_json(worksheet_q10, { header: 1 });

                                                        let k = XLSX.utils.sheet_to_json(worksheet_tmp11, { header: 1 });

                                                        
                            
                                                        b =l.concat(['']).concat(b).concat(['']).concat(m).concat(['']).concat(c).concat(['']).concat(n).concat(['']).concat(d).concat(['']).concat(o).concat(['']).concat(e).concat(['']).concat(p).concat(['']).concat(f).concat(['']).concat(q).concat(['']).concat(g).concat(['']).concat(r).concat(['']).concat(h).concat(['']).concat(s).concat(['']).concat(i).concat(['']).concat(t).concat(['']).concat(j).concat(['']).concat(u).concat(['']).concat(k)
                                                        
                                                        let worksheet = XLSX.utils.json_to_sheet(a, { skipHeader: true })
                                                        let worksheet2 = XLSX.utils.json_to_sheet(b, { skipHeader: true })

                                                        const new_workbook = XLSX.utils.book_new()
                                                        XLSX.utils.book_append_sheet(new_workbook, worksheet, "Submissions Info");
                                                        XLSX.utils.book_append_sheet(new_workbook, worksheet2, "Responses");
                                                        XLSX.writeFile(new_workbook, '<%=surveyToView.name%> Results.xls')
                                                         
                                                     }
                                                 
                                                     const export_button = document.getElementById('download');
                                                 
                                                     export_button.addEventListener('click', () =>  {
                                                         html_table_to_excel('xlsx');
                                                     });
                                                    </script>
                                                    <% } %>
               <br>
               <br>
            </div>

            </div>

            <%- include ../Partials/bottom_nav.ejs%>

                <%- include ../Partials/footer.ejs%>
                
